name: mem-kernel-quick-verify

services:
  qdrant:
    image: qdrant/qdrant:v1.11.0
    ports:
      - "6334:6334"
    volumes:
      - qdrant_data:/qdrant/storage

  embed-mock:
    build:
      context: ./embed-mock
    ports:
      - "8088:8088"

  api:
    build:
      context: ../..
      dockerfile: deployments/compose/Dockerfile.api
    environment:
      MEMOS_LISTEN: 0.0.0.0:8001
      RUST_LOG: info
      QDRANT_URL: http://qdrant:6334
      QDRANT_COLLECTION: memos
      EMBED_API_URL: http://embed-mock:8088/v1/embeddings
    ports:
      - "8001:8001"
    depends_on:
      - qdrant
      - embed-mock

volumes:
  qdrant_data:
